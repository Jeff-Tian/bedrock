bedrock

---

> 调用 AWS Bedrock 服务，为微信公众号消息提供自动回复功能。

## 测试

```bash
yarn test
```

## 部署

可以部署到任意 Kubernetes 集群。注意目前 replica 设置成了 1，原因是使用了内存缓存，如果设置成多个 Pod，会导致缓存失效。

## 缓存

由于微信公众号消息只等待 5 秒，而调用 AWS Bedrock 服务很可能在超过 5 秒后才能得到响应。超时后微信会再重试请求，为了避免重复调用 AWS Bedrock 服务，这里使用了内存缓存，如果是同一消息，就不再调用 AWS Bedrock 服务，而是等待上次的调用结果。

## 公众号后台配置

如何让你的微信公众号支持自动回复功能？只需要将该项目部署，然后在公众号后台配置即可。

![](./WX20240112-115802@2x.png)
